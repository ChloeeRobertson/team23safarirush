<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Load Board From String</title>
<style>
    .tile {
        position: absolute;
    }

    #board {
        width: 360px;
        height: 360px;
        position: relative;
        background: #999966;
    }
</style>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="../js/loadLevel.js"></script>
<!--<script src="http://rawgithub.com/briangonzalez/jquery.pep.js/master/src/jquery.pep.js"></script>

<script>
// /**
//  * Level string. Contains info of all pieces and board size.
//  *      - Could use AJAX to retrieve level from MySQL db.
//  *
//  * 6        Number of tiles - assumed square
//  *
//  * 5, 2     Goal X & Y Coordinate (Where the Jeep is suppose to go)
//  *          [x, y] : [5, 2]
//  *
//  * 0013     Top left tile of piece [x, y] : [0, 0]
//  *  .       Width and height of piece [w, h] : [1, 3]
//  *  .
//  *  .
//  * 1221j    The 'j' stands for Jeep. Every level must have 1 Jeep.
//  */
// // var levelString = '6,5,2,0013,0531,1221j,1312,2012,2421,3031,3113,4213,5112,5312';
// var levelString = '6,5,2,0031,0221g,0312,0521,1121,1421,2212,2521,3012,3212,3421,4012,4321,5012';
// // var levelString = '6,5,2,0021,0113,0521,1112,1321,2012,2221g,3313,4112,4421,5012,5212';

// /**
//  * Makes a level object and returns it.
//  *
//  * @param levelString   A formatted string containing level info:
//  *                      - Board size
//  *                      - Goal XY Coordinate (Where the Jeep is suppose to go)
//  *                      - Pieces information (Jeep, animal size and position)
//  *
//  * @returns {{boardW: *, boardH: *, goalX: *, goalY: *, pieces: Array}}
//  */
// function makeLevelObject( levelString ) {

//     // Splits the levelString into an array
//     var parts = levelString.split( "," );

//     // Create all level pieces
//     // Pieces starts at index 3, previous elements store other info
//     var pieces = [];
//     for ( var i = 3; i < parts.length; i++ ) {
//         var id = i - 3;
//         pieces.push( makePieceObject( id, parts[i] ) );
//     }

//     // Create and return a level object
//     return {

//         // Board size - assumed square board
//         boardSize:  parts[0],

//         // Level ends when Jeep gets to goal
//         goalX:      parts[1],
//         goalY:      parts[2],

//         // Array of individual piece objects
//         pieces:     pieces
//     };
// }

// /**
//  * Makes a piece object and returns it.
//  *
//  * @param pieceString       A formatted string containing piece info:
//  *                          - X & Y Position (Column #, Row #)
//  *                          - Width & Height (Measured in # of tiles)
//  *                          - Jeep or Animal (extra character for Jeep in string)
//  *
//  * @returns {{x: Number, y: Number, w: Number, h: Number, isJeep: boolean}}
//  */
// function makePieceObject( id, pieceString ) {

//     // Create & return a piece object
//     // string[1] is equivalent to string.charAt(1)
//     return {
//         id: parseInt( id ),
//         x: parseInt( pieceString[0] ),
//         y: parseInt( pieceString[1] ),
//         w: parseInt( pieceString[2] ),
//         h: parseInt( pieceString[3] ),
//         isJeep: pieceString[4] ? true : false
//     };
// }

// /**
//  * Makes a DOM object for one piece and returns it.
//  *
//  * @param id            Piece ID.
//  * @param piece         Piece object.
//  * @param tileSize      Tile size - assumed square.
//  * @returns {*|jQuery}
//  */
// function makePieceDom( id, piece, tileSize ) {

//     // Differentiate between the Jeep and animals
//     var bgColor = piece.isJeep ? 'black' : randomColor();

//     // Moves horizontally or vertically?
//     var orientation = piece.w == 1 ? 'dragY' : 'dragX';

//     // Create and return a DOM element
//     return $( '<div></div>' )
//             .addClass( 'tile ' + orientation )
//             .attr( 'id', 'piece' + id )
//             .css( {
//                 width:  piece.w * tileSize,
//                 height: piece.h * tileSize,
//                 left:   piece.x * tileSize,
//                 top:    piece.y * tileSize,
//                 'background-color': bgColor
//             } );
// }

// /**
//  * Loads the level onto the browser.
//  *
//  * @param levelString   Level object.
//  * @param boardId       ID of board element in DOM.
//  * @param callback      Callback function invoked when level loaded.
//  */
// function loadLevel( levelString, boardId, callback ) {

//     // jQuery wrapped board - assumed valid boardId
//     var board = $( '#' + boardId );

//     // Level object
//     var level = makeLevelObject( levelString );

//     // Tile size in pixels - assumed square board
//     var tileSize = board.width() / level.boardSize;

//     // Set grid size and reset tiles
//     grid.setSize( level.boardSize );
//     grid.setPieces( level.pieces );

//     // Make DOM objects for all pieces and append to the board
//     for ( var i = 0; i < level.pieces.length; i++ ) {

//         // Current piece
//         var p = level.pieces[i];

//         // Track piece on grid
//         // grid.setPiece( i, p.x, p.y, p.w, p.h );

//         // Add new DOM object piece to board
//         board.append( makePieceDom( i, p, tileSize ) );

//         // Piece loaded, callback
//         callback( i, p, tileSize );
//     }

//     // Level loaded, call callback()
//     // Need to be called on each piece due to bug in jquery.pep
//     // when using constrainTo coordinates
//     // callback(tileSize);
// }

// // Generates a random color with hash-tag (#) in front
// function randomColor() {
//     var colors = [
//         'cc0099',
//         '0066ff',
//         '009933',
//         'ff6600'
//     ];

//     var randomIndex = Math.floor( Math.random() * colors.length );

//     return '#' + colors[randomIndex];
// }

































// var grid = {

//     tiles: [],

//     // Empty tiles hold this value instead of piece #ID
//     EMPTY: -1,

//     // Sets size of grid - assumed square
//     setSize: function( size ) {
//         this.tiles = [];
//         for (var x = 0; x < size; x++) {
//             this.tiles[x] = [];
//             for (var y = 0; y < size; y++) {
//                 this.tiles[x][y] = this.EMPTY;
//             }
//         }
//     },

//     setPieces: function( pieces ) {
//         pieces.forEach( function( p ) {
//             this.setPiece( p.id, p.x, p.y, p.w, p.h );
//         }, this );
//     },

//     setPiece: function( id, x, y, w, h ) {
//         for ( var xCount = 0; xCount < w; xCount++ ) {
//             for ( var yCount = 0; yCount < h; yCount++ ) {
//                 this.tiles[x + xCount][y + yCount] = id;
//             }
//         }
//     },

    

//     getConstraints: function( id, x, y, w, h, movesHorizontally, tileSize ) {

//         var range = this.getConstraintRange( id, x, y, movesHorizontally );

//         if ( movesHorizontally ) {
//             var top     = tileSize * y;
//             var left    = tileSize * range[0];
//             var right   = tileSize * ( range[1] + 1 - w );
//             var bottom  = tileSize * ( y + 1 - h );
//         } else {
//             var top     = tileSize * range[0];
//             var left    = tileSize * x;
//             var right   = tileSize * ( x + 1 - w );
//             var bottom  = tileSize * ( range[1] + 1 - h );
//         }

//         return [
//             top, right, bottom, left
//         ];
//     },

//     getConstraintRange: function( id, x, y, movesHorizontally ) {
//         var min = mid = max = ( movesHorizontally ) ? x : y;

//         for ( var i = 0; i < this.tiles.length; i++ ) {
//             var ownerId = movesHorizontally ? this.tiles[i][y] : this.tiles[x][i];

//             if ( i < mid ) {
//                 if ( ownerId == id || ownerId == this.EMPTY ) {
//                     min = ( min == mid ) ? i : min;
//                 } else {
//                     min = mid;
//                 }
//             } else if ( i > mid ) {
//                 if ( ownerId == id || ownerId == this.EMPTY ) {
//                     max = i;
//                 } else {
//                     break;
//                 }
//             }
//         }

//         return [min, max];
//     }
// };

































// // After board container loads, load the board pieces
// $( '#board' ).ready( function() {
//     loadBoard();
// } );

// // Load the board
// function loadBoard() {
//     loadLevel( levelString, 'board', loadPep );
// }

// // Clear the board
// function clearBoard() {
//     $( '#board' ).empty();
// }
































// // Callback function after tile movement
// function drag( mouseEvent, pepObject, tileSize ) {
//     // console.log( mouseEvent );
//     // console.log( pepObject );

//     // var x = pepObject.el.offsetLeft;
//     // var y = pepObject.el.offsetTop;

//     // console.log( pxToGridCoordinates( x, y, tileSize ) );
//     console.log( pepObject.el.id );
// }

// // Callback function after a piece loads
// function loadPep( id, piece, tileSize ) {

//     // Piece moves horizontally
//     var movesHorizontally = ( piece.h == 1 );
//     var constraints = grid.getConstraints( id, piece.x, piece.y, piece.w, piece.h, movesHorizontally, tileSize );

//     $( '#piece' + id ).pep( {
//         axis:               movesHorizontally ? 'x' : 'y',
//         grid:               [tileSize, tileSize],
//         shouldEase:         false,
//         useCSSTranslation:  false,
//         drag:               function( a, b ) { drag( a, b, tileSize ); },
//         constrainTo:        constraints,
//         debug:              true
//     } );


//     // $('.dragX').data('plugin_pep').options.constrainTo = [0, 0, 0, 0];
// }
</script>-->

<script>
function lvl1() {
    var lvlString = '6,5,2,0021,5013,0113,3113,1221j,0412,4421,2531';
    loadLevel( lvlString, 'board' );
}

function lvl2() {
    var lvlString = '6,5,2,0013,0531,1221j,1312,2012,2421,3031,3113,4213,5112,5312';
    loadLevel( lvlString, 'board' );
}

// After board container loads, load the board pieces
$( '#board' ).ready( function() {
    lvl1();
} );
</script>
</head>
<body>

<div id="board" class="board"></div>

<br><br> 
<a href="#" onclick="lvl1();">Level 1 (Default)</a><br>
<a href="#" onclick="lvl2();">Level 2</a><br>

</body>
</html>